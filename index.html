<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="de"  class="supernova "><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Jotform Image Compression Widget</title>

<!-- Bestehende Jotform-Skripte -->
<script src="https://cdn03.jotfor.ms/static/prototype.forms.js" type="text/javascript"></script>
<script src="https://cdn01.jotfor.ms/static/jotform.forms.js" type="text/javascript"></script>
<script src="https://cdn02.jotfor.ms/js/vendor/imageinfo.js" type="text/javascript"></script>
<script src="https://cdn03.jotfor.ms/file-uploader/fileuploader.js" type="text/javascript"></script>
<script src="https://cdn01.jotfor.ms/js/vendor/smoothscroll.min.js" type="text/javascript"></script>
<script src="https://cdn02.jotfor.ms/js/errorNavigation.js" type="text/javascript"></script>
</head>
<body>
<form class="jotform-form" action="https://submit.jotform.com/submit/250692894870067" method="post" enctype="multipart/form-data" name="form_250692894870067" id="250692894870067" accept-charset="utf-8" autocomplete="on">
  
  <label for="input_5">Auftragsnummer</label>
  <input type="text" id="input_5" name="q5_auftragsnummer" required>
  
  <label for="input_6">Kennzeichen</label>
  <input type="text" id="input_6" name="q6_kennzeichen" required>
  
  <label for="input_7">FahrzeugIdentNummer</label>
  <input type="text" id="input_7" name="q7_fahrzeugidentnummer" required>
  
  <label for="input_4">Lichtbilddateien</label>
  <input type="file" id="input_4" name="q4_lichtbilddateien[]" multiple accept="image/*">
  
  <button type="submit">Absenden</button>
</form>

<!-- Bildverkleinerung vor dem Upload -->
<script>
document.getElementById('input_4').addEventListener('change', function(event) {
    const files = event.target.files;
    const dataTransfer = new DataTransfer();

    Array.from(files).forEach(file => {
        if (file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = function(event) {
                const img = new Image();
                img.src = event.target.result;
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');

                    const maxWidth = 1024;
                    const maxHeight = 768;
                    let width = img.width;
                    let height = img.height;

                    if (width > maxWidth || height > maxHeight) {
                        const ratio = Math.min(maxWidth / width, maxHeight / height);
                        width = Math.round(width * ratio);
                        height = Math.round(height * ratio);
                    }

                    canvas.width = width;
                    canvas.height = height;
                    ctx.drawImage(img, 0, 0, width, height);

                    canvas.toBlob(function(blob) {
                        const compressedFile = new File([blob], file.name, { type: file.type, lastModified: Date.now() });
                        dataTransfer.items.add(compressedFile);
                        document.getElementById('input_4').files = dataTransfer.files;
                    }, file.type, 1.0);
                };
            };
        } else {
            dataTransfer.items.add(file);
        }
    });

    event.target.files = dataTransfer.files;
});
</script>

</body>
</html>
